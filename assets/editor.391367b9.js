var t=Object.defineProperty,e=(e,s,o)=>(((e,s,o)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o})(e,"symbol"!=typeof s?s+"":s,o),o);import"./modulepreload-polyfill.b7f2da20.js";import{Q as s,d as o}from"./vendor.083fda57.js";hljs.configure({languages:["javascript","ruby","python"]}),hljs.safeMode(),function(t){const s=t.import("blots/block/embed");class o extends s{constructor(){super(...arguments),e(this,"file",{}),e(this,"state","beforeCreate"),e(this,"node",null)}static create(t){console.log(t);const{File:e,callback:s}=t;return e?(this.file=e,console.log("create",e)):this.file=t,this.node=super.create(),this.node.setAttribute("contenteditable","false"),this.node.setAttribute("width","100%"),this.transformValue(),this.file.state?this.setState(this.file.state):(this.setState("beforeUpload"),this.upload(s)),console.log(this.node),this.node}static transformValue(){const t=this.file;let e=`<span class="filename">${"success"==this.state?t.size:""+t.name}</span>`.split("\n");e=e.map((t=>t.replace(/^[\s]+/,"").replace(/[\s]+$/,""))),console.log(e),this.node.innerHTML=e.join("")}static setState(t){this.state=t,this.node.setAttribute("data-status",t)}static upload(t){setTimeout((()=>{this.setState("success"),this.transformValue(),t&&t("success")}),1e3)}static value(){const{name:t,size:e}=this.file;return{name:t,size:e,state:this.state}}}o.blotName="FileEmbed",o.className="embed-file",o.tagName="div",t.register(o,!0)}(Quill);var n,l=new class{constructor(t,s){return e(this,"quill",null),e(this,"dom","#editor-container"),e(this,"defaultOption",{modules:{syntax:!0,toolbar:[["code-block"]]},placeholder:" ",theme:"snow",pasteFile:!0,pasteFileCallback:function(t){}}),e(this,"option",{}),this.dom=t,this.option="object"==typeof s?s:this.defaultOption,this.init()}init(){let t=new Quill(this.dom,this.option);return this.quill=t,console.log(this),this.option.pasteFile&&document.getElementById("editor-container").addEventListener("paste",(function(e){let s=e.clipboardData;if(s){let e=s.items;if(e.length)for(let s=0;s<e.length;s++){let o=e[s];if("file"===o.kind){let e=o.getAsFile();if(console.log("file"),console.log(e),console.log(t.getLength()),o.type.startsWith("image/")){if(e.size>=20480){console.log("loading"),alert("文件超大");break}let s=new FileReader;s.readAsDataURL(e),s.onload=e=>{t.insertEmbed(t.getLength(),"image",e.target.result)}}else t.insertEmbed(t.getLength()-1,"FileEmbed",{File:e,callback:i()}),console.log(e)}else console.log("txt",o)}}}),!1),this.quill.clipboard.addMatcher(Node.TEXT_NODE,(function(t,e){return(new o).insert(t.data,{color:"#000",bold:!1,background:"#fff"})})),this.quill}getContents(t=function(){}){let e=l.getContents();return e.forEach(t),e}setContents(t=[]){l.setContents(t)}}("#editor-container");function i(){let t=l.getContents();window.localStorage.setItem("textStorage",JSON.stringify(t))}!function(){let t=window.localStorage.getItem("textStorage");t&&(console.log(t),l.setContents(JSON.parse(t).ops))}(),l.on("text-change",(function(t,e,s){"api"==s?console.log("An API call triggered this change."):"user"==s&&console.log("A user action triggered this change."),clearTimeout(n),n=setTimeout((()=>{console.log(t,e,s),i()}),1e3)})),document.getElementById("set").onclick=function(){l.setContents([{insert:"Hello quill\n"},{insert:{image:"https://qn.soulfree.cn/Snipaste_2021-06-27_13-48-51.png?imageView2/1/w/1200/h/800/interlace/1/q/1"}},{insert:"\n"},{insert:{},attributes:{width:420,height:315}}])},document.getElementById("send").onclick=function(){l.getContents()},document.getElementById("gettext").onclick=function(){let t=l.getText(0,l.getLength());console.log(JSON.stringify(t))};class a{constructor(t,s){e(this,"quill",null),e(this,"ops",[]),e(this,"dom",null),e(this,"defaultOption",{modules:{toolbar:""},placeholder:" ",theme:"snow",readonly:!0}),e(this,"quill",null),console.log(t,s);let o=new Quill(t,{modules:{toolbar:""},placeholder:" ",theme:"snow",readonly:!0});return o.setContents(s),this.quill=o,o}}s({chartList:[],send(){let t=l.getContents();this.chartList.push(t),console.log(JSON.stringify(t));let e=this.chartList.length-1;this.$nextTick((function(){new a(document.getElementById("li"+e),t.ops)}))}}).mount("body");
